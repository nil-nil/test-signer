# Test Signer

## Development

### Database

This project uses Postgres. You need [Tern](https://github.com/jackc/tern) to run migrations.

Once installed, create a `tern.conf` file in `internal/repository/migrations` and run `tern migrate`.

The postgres connection string can be passed using the -db parameter e.g. `-db postgres://postgres:@127.0.0.1:5434/toggl`

### Keys

New keys can be generated by running `go run main.go init`. This will generate the jwt keys and the nacl siging key.

## Usage

Run `go run main.go run` to start the server.

### Routes

- GET `/signatures/:signature` gets a signature from the database.
- POST `/signatures` creates a new signature. The body of the request should be JSON and in the form of a dict: `{"quastion": "answer"}`

### Auth

You should provide a valid JWT using the `Authorization` header in the form `Bearer ...`.

For testing you may generate a token using `go run main.go token :id`, giving a user ID as :id.
